---
title: export
date: 2017-08-14
tags: web, tools
---

+ 导出到Excel
+ 需求：
    1>Excel 格式的统一配置
    2> 异步导出
        + 问题描述：主线程内导出会卡死
        + 前台发出请求后，异步创建Excel，并写入Redis缓存，前台判断Excel写入完成后确认可下载
+ 思路：
    + 前台发出导出请求；
    + 抛出命令->异步生成表格，写入redis缓存
    + 前台请求redis缓存是否写完了表格
        +  完成，提供下载
        + 未完成继续请求
    + 步骤：
        +  生成表格：
            + 表格内数据特点：value， name；（FieldDef<>）
                + 所以可以对其进行统一配置，更易管理，减少出错;
                + 通过List，用到那个字段，对那个字段定义如何取值即可；
                + 通用性：下次导出只需要进行字段的配置即可；
        + Redis缓存：
                + TaskKey
                + 操作间隔：Taskkey（）是否存在，存在就直接下载（对于数据量大，变动很小的情况）；
                    + TaskLockService
                        + 